<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Video Lab Pro - Match Analysis</title>
    <link rel="stylesheet" href="https://cdn.plyr.io/3.7.8/plyr.css" />
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css" />
    <style>
        :root { --primary: #00b3ff; --bg: #f4f7f9; --highlight: #e0f4ff; --dark: #1e293b; --topbar-h: 60px; }
        
        html, body { margin: 0; padding: 0; font-family: 'Segoe UI', sans-serif; background: var(--bg); height: 100vh; width: 100vw; overflow: hidden; }

        /* Topbar */
        .top-nav { height: var(--topbar-h); background: var(--dark); color: white; display: flex; align-items: center; justify-content: space-between; padding: 0 10px; position: fixed; top: 0; width: 100%; z-index: 1001; box-sizing: border-box; }
        .nav-left { display: flex; align-items: baseline; gap: 10px; overflow: hidden; flex: 1; min-width: 0; }
        .nav-left h1 { margin: 0; font-size: 1rem; font-weight: 300; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .nav-left h1 b { color: var(--primary); }
        #event-date { opacity: 0.6; font-size: 0.75rem; white-space: nowrap; }

        .nav-right { display: flex; align-items: center; gap: 8px; flex-shrink: 0; }
        .btn-main { background: var(--primary); color: white; border: none; padding: 8px 12px; border-radius: 6px; cursor: pointer; font-weight: bold; font-size: 0.75rem; display: flex; align-items: center; gap: 5px; }
        
        #globalResetBtn { display: none; background: #334155; color: var(--primary); border: 1px solid var(--primary); padding: 8px 10px; border-radius: 6px; cursor: pointer; font-size: 1rem; }
        .btn-icon { background: #334155; color: white; border: none; padding: 8px 12px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; }
        .hamburger { display: block; background: none; border: none; color: white; font-size: 1.5rem; cursor: pointer; padding: 5px; }

        .nav-menu { display: flex; align-items: center; gap: 10px; }

        /* Layout Main */
        .main-layout { display: flex; flex-direction: column; gap: 20px; padding: 15px; margin-top: var(--topbar-h); height: calc(100vh - var(--topbar-h)); box-sizing: border-box; }

        /* FIX SCROLL TOUCH: Firefox/Mobile */
        .table-container-scroll, .dataTables_scrollBody {
            -webkit-overflow-scrolling: touch !important;
            overflow-y: auto !important;
            touch-action: pan-y !important;
        }

        @media (max-width: 991px) {
            html, body { overflow-y: auto !important; height: auto !important; position: relative; }
            .main-layout { height: auto; display: block; padding-bottom: 50px; }
            .nav-menu { display: none; position: absolute; top: var(--topbar-h); right: 0; background: var(--dark); flex-direction: column; width: 180px; padding: 15px; box-shadow: -5px 5px 15px rgba(0,0,0,0.3); border-radius: 0 0 0 12px; }
            .nav-menu.open { display: flex !important; }
            .table-column { height: 60vh; min-height: 400px; margin-top: 20px; background: white; border-radius: 12px; padding: 10px; }
            .video-column { width: 100%; }
        }

        @media (min-width: 992px) {
            .hamburger { display: none !important; }
            .nav-menu { display: flex !important; position: static; background: none; padding: 0; width: auto; box-shadow: none; flex-direction: row; }
            .main-layout { flex-direction: row-reverse; padding: 20px; } 
            .video-column { flex: 2; } 
            .table-column { flex: 0 0 450px; background: white; border-radius: 12px; padding: 15px; display: flex; flex-direction: column; overflow: hidden; }
        }

        .video-wrapper { background: #000; border-radius: 12px; overflow: hidden; aspect-ratio: 16 / 9; }
        .table-container-scroll { flex: 1; overflow: hidden; }

        .dataTables_filter, .dataTables_info { display: none !important; }
        table.dataTable tbody tr.active-row td { background-color: var(--highlight) !important; color: var(--primary); font-weight: bold; border-left: 4px solid var(--primary); }
        
        .modal { display: none; position: fixed; z-index: 2000; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); }
        .modal-content { background: white; margin: 10% auto; padding: 20px; border-radius: 12px; width: 85%; max-width: 400px; }
        .control-unit { display: flex; align-items: center; gap: 8px; }
        .control-unit input { width: 45px; background: #334155; border: 1px solid #475569; color: white; padding: 4px; border-radius: 4px; text-align: center; }
    </style>
</head>
<body>

    <nav class="top-nav">
        <div class="nav-left">
            <h1 id="main-title">VIDEO<b>LAB</b></h1>
            <span id="event-date">...</span>
        </div>
        <div class="nav-right">
            <button id="globalResetBtn" onclick="resetAll()">üßπ</button>
            <button id="playBtn" class="btn-main">‚ñ∂ PLAY</button>
            <button class="hamburger" onclick="toggleMobileMenu(event)">‚ò∞</button>
            <div class="nav-menu" id="navMenu">
                <div class="control-unit"><label style="font-size:0.6rem; color:#94a3b8;">OFFSET</label><input type="number" id="offsetSeconds" value="0"></div>
                <button class="btn-icon" onclick="toggleModal('filterModal', true); $('#navMenu').removeClass('open');">üîç FILTRI</button>
                <button id="detailsBtn" class="btn-main" style="background:#64748b; opacity: 0.2; pointer-events: none;">üìÑ INFO</button>
            </div>
        </div>
    </nav>

    <div class="main-layout">
        <div class="video-column"><div class="video-wrapper"><div id="player-container"><div id="player" data-plyr-provider="youtube" data-plyr-embed-id=""></div></div></div></div>
        <div class="table-column"><div class="table-container-scroll"><table id="videoTable" class="display nowrap" style="width:100%"><thead><tr><th>#</th><th>Evento</th><th>Player</th><th>Team</th><th>Per</th></tr></thead><tbody id="video-table-body"></tbody></table></div></div>
    </div>

    <div id="filterModal" class="modal"><div class="modal-content"><h3>Filtri</h3><div id="filter-container"></div><div style="text-align:right; margin-top:20px;"><button class="btn-icon" style="background:#ef4444; display:inline-block; margin-right:5px;" onclick="resetFilters()">Reset</button><button class="btn-icon" style="background:var(--primary); display:inline-block;" onclick="applyFilters()">Applica</button></div></div></div>
    <div id="detailsModal" class="modal"><div class="modal-content"><div style="display:flex; justify-content:space-between;"><h3>Dettagli</h3><button onclick="toggleModal('detailsModal', false)" style="border:none; background:none; font-size:1.5rem; cursor:pointer;">&times;</button></div><div id="details-container"></div></div></div>

    <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pako/2.1.0/pako.min.js"></script>
    <script src="https://cdn.plyr.io/3.7.8/plyr.polyfilled.js"></script>
    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
    <script src="script.js"></script>
</body>
</html>